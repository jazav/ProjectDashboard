SELECT bugs.jira_key, bugs.cname AS 'components', bugs.SUMMARY AS 'summary', bugs.pname AS 'priority',
	CONVERT(date, chg.CREATED) AS 'change_date',
	chi.OLDSTRING AS 'old_status', chi.NEWSTRING AS 'new_status'
FROM [srv-jira-prod-report].[dbo].[changegroup] AS chg
	INNER JOIN [srv-jira-prod-report].[dbo].[changeitem] AS chi ON chi.groupid = chg.ID,
	(
	SELECT CONCAT_WS('-', prj.pkey, ji.issuenum) AS 'jira_key', ji.SUMMARY, ji.ID, pr.pname, cmp.cname
	FROM [srv-jira-prod-report].[dbo].[jiraissue] AS ji
		INNER JOIN [srv-jira-prod-report].[dbo].[project] AS prj ON prj.ID = ji.PROJECT
		INNER JOIN [srv-jira-prod-report].[dbo].[issuetype] AS it ON it.ID = ji.issuetype
		INNER JOIN [srv-jira-prod-report].[dbo].[issuestatus] AS ist ON ist.ID = ji.issuestatus
		INNER JOIN [srv-jira-prod-report].[dbo].[priority] AS pr ON pr.ID = ji.PRIORITY
		INNER JOIN [srv-jira-prod-report].[dbo].[nodeassociation] AS na ON na.SOURCE_NODE_ID = ji.ID
		INNER JOIN [srv-jira-prod-report].[dbo].[component] AS cmp ON cmp.ID = na.SINK_NODE_ID
	WHERE prj.pname = 'BSSBOX'
		AND it.pname = 'Bug'
		AND pr.pname IN ('Critical', 'Blocker')
		AND ji.CREATED > '2019-01-29 00:00:00.000'
	) AS bugs
WHERE chi.FIELD = 'status'
	AND chg.issueid IN (bugs.ID)
ORDER BY jira_key, change_date